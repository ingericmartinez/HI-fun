<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Crucigrama</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos personalizados para el crucigrama */
        body {
            font-family: 'Inter', sans-serif;
        }
        .grid-cell {
            width: 40px;
            height: 40px;
            border: 1px solid #d1d5db; /* gray-300 */
            text-align: center;
            font-size: 1.25rem;
            text-transform: uppercase;
            caret-color: #3b82f6; /* blue-500 */
        }
        .grid-cell:focus {
            outline: 2px solid #3b82f6; /* blue-500 */
            z-index: 10;
        }
        .black-cell {
            background-color: #1f2937; /* gray-800 */
            border: 1px solid #1f2937;
        }
        .number-label {
            position: absolute;
            top: 1px;
            left: 2px;
            font-size: 0.7rem;
            font-weight: bold;
            color: #4b5563; /* gray-600 */
        }
        .cell-container {
            position: relative;
        }
        .highlight {
            background-color: #dbeafe; /* blue-100 */
        }
        .correct {
            background-color: #dcfce7; /* green-100 */
            color: #166534; /* green-800 */
            border-color: #22c55e; /* green-500 */
        }
        .incorrect {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
            border-color: #ef4444; /* red-500 */
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-2xl w-full max-w-4xl mx-auto">
        <h1 class="text-3xl md:text-4xl font-bold text-center text-slate-800 mb-2">Letras Cruzadas</h1>
        <div id="timer-display" class="text-center text-2xl font-bold text-slate-600 mb-6">1:00</div>
        
        <div class="relative"> <!-- Contenedor relativo para el mensaje de tiempo agotado -->
            <div id="times-up-container" class="absolute inset-0 bg-white/80 backdrop-blur-sm z-20 flex-col items-center justify-center rounded-lg hidden">
                <p class="text-2xl font-bold text-slate-800">¡Tiempo agotado!</p>
                <button id="reveal-button" class="mt-4 bg-amber-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-amber-600 transition-colors shadow-md">
                    Revelar Respuestas
                </button>
            </div>

            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Columna del Crucigrama -->
                <div class="flex-grow flex flex-col items-center">
                    <div id="crossword-grid" class="grid gap-0.5 bg-slate-400 p-2 rounded-lg shadow-inner">
                        <!-- El grid se generará aquí con JavaScript -->
                    </div>
                    <button id="check-button" class="mt-6 bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-colors shadow-md">
                        Revisar Respuestas
                    </button>
                     <div id="message-area" class="mt-4 text-center font-semibold h-6"></div>
                </div>

                <!-- Columna de Pistas -->
                <div class="w-full lg:w-96 bg-slate-50 p-6 rounded-lg shadow-inner">
                    <div id="clues-container">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-700 border-b-2 border-slate-200 pb-2 mb-3">Horizontales</h2>
                            <ul id="horizontal-clues" class="space-y-3"></ul>
                        </div>
                        <div class="mt-6">
                            <h2 class="text-2xl font-bold text-slate-700 border-b-2 border-slate-200 pb-2 mb-3">Verticales</h2>
                            <ul id="vertical-clues" class="space-y-3"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Datos del Crucigrama ---
            const puzzleData = {
                rows: 8,
                cols: 9,
                words: [
                    { index: 1, word: "NUEVO", clue: "Comienza con N y termina con O (5 letras): Lo contrario de viejo.", row: 1, col: 3, direction: "horizontal" },
                    { index: 2, word: "COMO", clue: "Comienza con C y termina con O (4 letras): Se usa para comparar.", row: 5, col: 1, direction: "horizontal" },
                    { index: 3, word: "PATO", clue: "Comienza con P y termina con O (4 letras): Ave que nada y dice 'cuac'.", row: 3, col: 0, direction: "horizontal" },
                    { index: 4, word: "PERMISO", clue: "Comienza con P y termina con O (7 letras): Pedir autorización.", row: 0, col: 5, direction: "vertical" },
                    { index: 5, word: "MOTIN", clue: "Comienza con M y termina con N (5 letras): Una revuelta o levantamiento.", row: 3, col: 2, direction: "vertical" },
                ]
            };

            const gridElement = document.getElementById('crossword-grid');
            const horizontalCluesList = document.getElementById('horizontal-clues');
            const verticalCluesList = document.getElementById('vertical-clues');
            const checkButton = document.getElementById('check-button');
            const messageArea = document.getElementById('message-area');
            const timerDisplay = document.getElementById('timer-display');
            const timesUpContainer = document.getElementById('times-up-container');
            const revealButton = document.getElementById('reveal-button');

            let gridState = [];
            let timerInterval;
            let timeLeft = 60;

            // --- Generación del Grid y Pistas ---
            function generateGame() {
                clearInterval(timerInterval);
                timeLeft = 60;
                timerDisplay.textContent = '1:00';
                timesUpContainer.classList.add('hidden');
                
                gridElement.innerHTML = '';
                horizontalCluesList.innerHTML = '';
                verticalCluesList.innerHTML = '';
                gridState = Array.from({ length: puzzleData.rows }, () => Array(puzzleData.cols).fill(null));

                gridElement.style.gridTemplateColumns = `repeat(${puzzleData.cols}, 40px)`;

                // Poblar el gridState con la información de las palabras
                puzzleData.words.forEach((wordData) => {
                    for (let i = 0; i < wordData.word.length; i++) {
                        const r = wordData.direction === 'vertical' ? wordData.row + i : wordData.row;
                        const c = wordData.direction === 'horizontal' ? wordData.col + i : wordData.col;
                        if (!gridState[r][c]) {
                            gridState[r][c] = { isLetter: true, words: [] };
                        }
                        gridState[r][c].words.push(wordData.index);
                    }
                });
                
                // Generar los elementos HTML del grid
                for (let r = 0; r < puzzleData.rows; r++) {
                    for (let c = 0; c < puzzleData.cols; c++) {
                        const cellContainer = document.createElement('div');
                        cellContainer.className = 'cell-container';

                        const startingWord = puzzleData.words.find(w => w.row === r && w.col === c);
                        if (startingWord) {
                            const numberLabel = document.createElement('span');
                            numberLabel.className = 'number-label';
                            numberLabel.textContent = startingWord.index;
                            cellContainer.appendChild(numberLabel);
                        }

                        if (gridState[r][c] && gridState[r][c].isLetter) {
                            const input = document.createElement('input');
                            input.type = 'text';
                            input.maxLength = 1;
                            input.className = 'grid-cell';
                            input.dataset.row = r;
                            input.dataset.col = c;
                            input.dataset.words = gridState[r][c].words.join(',');
                            cellContainer.appendChild(input);
                        } else {
                            const blackCell = document.createElement('div');
                            blackCell.className = 'black-cell';
                            cellContainer.appendChild(blackCell);
                        }
                        gridElement.appendChild(cellContainer);
                    }
                }

                // Rellenar la primera y última letra de cada palabra
                puzzleData.words.forEach(wordData => {
                    // Primera letra
                    const firstR = wordData.row;
                    const firstC = wordData.col;
                    const firstCell = document.querySelector(`.grid-cell[data-row="${firstR}"][data-col="${firstC}"]`);
                    if (firstCell) {
                        firstCell.value = wordData.word[0];
                        firstCell.disabled = true;
                        firstCell.classList.add('bg-slate-200', 'font-bold', 'text-slate-500');
                    }

                    // Última letra
                    const lastR = wordData.direction === 'vertical' ? wordData.row + wordData.word.length - 1 : wordData.row;
                    const lastC = wordData.direction === 'horizontal' ? wordData.col + wordData.word.length - 1 : wordData.col;
                    const lastCell = document.querySelector(`.grid-cell[data-row="${lastR}"][data-col="${lastC}"]`);
                    if (lastCell) {
                        lastCell.value = wordData.word[wordData.word.length - 1];
                        lastCell.disabled = true;
                        lastCell.classList.add('bg-slate-200', 'font-bold', 'text-slate-500');
                    }
                });

                // Generar las listas de pistas
                puzzleData.words.sort((a, b) => a.index - b.index).forEach(wordData => {
                    const listItem = document.createElement('li');
                    listItem.className = 'flex items-center justify-between text-slate-600';
                    listItem.innerHTML = `
                        <div class="flex-grow cursor-pointer" data-word-index="${wordData.index}">
                           <strong class="mr-2">${wordData.index}.</strong>
                           <span class="clue-text hidden italic text-slate-500">${wordData.clue}</span>
                           <button class="show-clue-button text-sm text-blue-600 hover:underline ml-1 focus:outline-none">(ver pista)</button>
                        </div>
                        <button class="hint-button text-xs bg-amber-100 text-amber-700 font-semibold px-2 py-1 rounded ml-2 hover:bg-amber-200 flex-shrink-0" data-word-index="${wordData.index}">Letra</button>
                    `;
                    if (wordData.direction === 'horizontal') {
                        horizontalCluesList.appendChild(listItem);
                    } else {
                        verticalCluesList.appendChild(listItem);
                    }
                });
                
                setupEventListeners();
                startTimer();
            }

            // --- Lógica de Eventos ---
            function setupEventListeners() {
                const inputs = document.querySelectorAll('.grid-cell');
                
                inputs.forEach(input => {
                    input.addEventListener('keyup', handleInputNavigation);
                    input.addEventListener('focus', () => highlightWords(input.dataset.words.split(',')));
                });

                document.querySelectorAll('#clues-container li > div[data-word-index]').forEach(clueWrapper => {
                    clueWrapper.addEventListener('click', (e) => {
                        // Evita que el click en el botón "ver pista" propague al div
                        if (e.target.classList.contains('show-clue-button')) return;
                        
                        const wordIndex = parseInt(clueWrapper.dataset.wordIndex, 10);
                        highlightWords([wordIndex]);
                        focusFirstLetter(wordIndex);
                    });
                });

                document.querySelectorAll('.show-clue-button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.stopPropagation(); // Prevenir que el click se propague al div contenedor
                        const parentDiv = e.target.parentElement;
                        const clueText = parentDiv.querySelector('.clue-text');
                        if (clueText) {
                            clueText.classList.remove('hidden');
                            e.target.style.display = 'none'; // Ocultar el botón
                        }
                    });
                });

                document.querySelectorAll('.hint-button').forEach(button => {
                    button.addEventListener('click', handleHint);
                });
                
                if (checkButton) {
                    checkButton.addEventListener('click', checkAnswers);
                }
                if (revealButton) {
                    revealButton.addEventListener('click', revealAllAnswers);
                }
            }
            
            function handleInputNavigation(e) {
                const input = e.target;
                const row = parseInt(input.dataset.row);
                const col = parseInt(input.dataset.col);

                if (e.key >= 'a' && e.key <= 'z' || e.key >= 'A' && e.key <= 'Z') {
                    const wordIndices = input.dataset.words.split(',');
                    const wordData = puzzleData.words.find(w => w.index == wordIndices[0]); // Prioritize one direction
                    
                    if (wordData.direction === 'horizontal') {
                        const nextInput = document.querySelector(`.grid-cell[data-row="${row}"][data-col="${col + 1}"]`);
                        if(nextInput) nextInput.focus();
                    } else {
                        const nextInput = document.querySelector(`.grid-cell[data-row="${row + 1}"][data-col="${col}"]`);
                        if(nextInput) nextInput.focus();
                    }
                }
            }

            function highlightWords(wordIndices) {
                document.querySelectorAll('.grid-cell').forEach(cell => cell.classList.remove('highlight'));
                wordIndices.forEach(wordIndex => {
                    const wordData = puzzleData.words.find(w => w.index == wordIndex);
                    if (wordData) {
                        for (let i = 0; i < wordData.word.length; i++) {
                            const r = wordData.direction === 'vertical' ? wordData.row + i : wordData.row;
                            const c = wordData.direction === 'horizontal' ? wordData.col + i : wordData.col;
                            const cell = document.querySelector(`.grid-cell[data-row="${r}"][data-col="${c}"]`);
                            if (cell) cell.classList.add('highlight');
                        }
                    }
                });
            }
            
            function focusFirstLetter(wordIndex) {
                 const wordData = puzzleData.words.find(w => w.index == wordIndex);
                 if(wordData) {
                    const firstCell = document.querySelector(`.grid-cell[data-row="${wordData.row}"][data-col="${wordData.col}"]`);
                    if(firstCell) firstCell.focus();
                 }
            }

            function handleHint(e) {
                const wordIndex = parseInt(e.target.dataset.wordIndex, 10);
                const wordData = puzzleData.words.find(w => w.index === wordIndex);
                if (!wordData) return;

                let revealed = false;
                for (let i = 0; i < wordData.word.length; i++) {
                    const r = wordData.direction === 'vertical' ? wordData.row + i : wordData.row;
                    const c = wordData.direction === 'horizontal' ? wordData.col + i : wordData.col;
                    const cell = document.querySelector(`.grid-cell[data-row="${r}"][data-col="${c}"]`);
                    if (cell && !cell.value) {
                        cell.value = wordData.word[i];
                        cell.classList.add('correct');
                        cell.disabled = true;
                        revealed = true;
                        break;
                    }
                }
                if (!revealed) {
                    messageArea.textContent = '¡Esa palabra ya está completa!';
                    setTimeout(() => messageArea.textContent = '', 2000);
                }
            }
            
            // --- Lógica del Temporizador ---
            function startTimer() {
                timerInterval = setInterval(() => {
                    timeLeft--;
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;

                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        handleTimeUp();
                    }
                }, 1000);
            }

            function handleTimeUp() {
                document.querySelectorAll('.grid-cell').forEach(input => input.disabled = true);
                if (checkButton) checkButton.disabled = true;
                timesUpContainer.classList.remove('hidden');
                timesUpContainer.classList.add('flex'); // Mostrar el contenedor
            }

            function revealAllAnswers() {
                puzzleData.words.forEach(wordData => {
                    for (let i = 0; i < wordData.word.length; i++) {
                        const r = wordData.direction === 'vertical' ? wordData.row + i : wordData.row;
                        const c = wordData.direction === 'horizontal' ? wordData.col + i : wordData.col;
                        const cell = document.querySelector(`.grid-cell[data-row="${r}"][data-col="${c}"]`);
                        if (cell) {
                            cell.value = wordData.word[i];
                            cell.classList.remove('incorrect');
                            cell.classList.add('correct');
                            cell.disabled = true;
                        }
                    }
                });
                timesUpContainer.classList.add('hidden');
                timesUpContainer.classList.remove('flex');
            }


            // --- Lógica de Verificación ---
            function checkAnswers() {
                let allCorrect = true;
                puzzleData.words.forEach(wordData => {
                    let userInput = '';
                    for (let i = 0; i < wordData.word.length; i++) {
                        const r = wordData.direction === 'vertical' ? wordData.row + i : wordData.row;
                        const c = wordData.direction === 'horizontal' ? wordData.col + i : wordData.col;
                        const cell = document.querySelector(`.grid-cell[data-row="${r}"][data-col="${c}"]`);
                        userInput += cell.value || ' ';
                    }

                    const isWordCorrect = userInput.toUpperCase() === wordData.word.toUpperCase();
                    if (!isWordCorrect) allCorrect = false;

                    for (let i = 0; i < wordData.word.length; i++) {
                        const r = wordData.direction === 'vertical' ? wordData.row + i : wordData.row;
                        const c = wordData.direction === 'horizontal' ? wordData.col + i : wordData.col;
                        const cell = document.querySelector(`.grid-cell[data-row="${r}"][data-col="${c}"]`);
                        cell.classList.remove('correct', 'incorrect');
                        if (cell.value) {
                             cell.classList.add(isWordCorrect ? 'correct' : 'incorrect');
                        }
                    }
                });
                
                if (allCorrect) {
                    messageArea.textContent = '¡Felicidades! ¡Has completado el crucigrama!';
                    messageArea.classList.add('text-green-600');
                    clearInterval(timerInterval); // Detener el timer si gana
                } else {
                    messageArea.textContent = 'Algunas respuestas no son correctas. ¡Sigue intentando!';
                     messageArea.classList.add('text-red-600');
                }
                setTimeout(() => {
                    messageArea.textContent = '';
                    messageArea.classList.remove('text-green-600', 'text-red-600');
                }, 4000);
            }

            // --- Iniciar el Juego ---
            generateGame();
        });
    </script>

</body>
</html>


